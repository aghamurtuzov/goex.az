(function(){function q(g,f,n,z){return new l(g,f,n,z)}function l(g,f,n,l){this.options=l||{};this.options.adapters=this.options.adapters||{};this.obj=g;this.keypath=f;this.callback=n;this.objectPath=[];this.update=this.update.bind(this);this.parse();v(this.target=this.realize())&&this.set(!0,this.key,this.target,this.callback)}function v(g){return"object"==typeof g&&null!==g}q.adapters={};l.tokenize=function(g,f,n){var l=[],p={i:n,path:""};for(n=0;n<g.length;n++){var q=g.charAt(n);~f.indexOf(q)?(l.push(p),
  p={i:q,path:""}):p.path+=q}return l.push(p),l};l.prototype.parse=function(){var g=this.interfaces();if(!g.length)throw Error("[sightglass] Must define at least one adapter interface.");if(~g.indexOf(this.keypath[0])){var f=this.keypath[0];var n=this.keypath.substr(1)}else{if("undefined"==typeof(f=this.options.root||q.root))throw Error("[sightglass] Must define a default root adapter.");n=this.keypath}this.tokens=l.tokenize(n,g,f);this.key=this.tokens.pop()};l.prototype.realize=function(){var g,f=
  this.obj,n=!1;return this.tokens.forEach(function(l,p){v(f)?("undefined"!=typeof this.objectPath[p]?f!==(g=this.objectPath[p])&&(this.set(!1,l,g,this.update),this.set(!0,l,f,this.update),this.objectPath[p]=f):(this.set(!0,l,f,this.update),this.objectPath[p]=f),f=this.get(l,f)):(!1===n&&(n=p),(g=this.objectPath[p])&&this.set(!1,l,g,this.update))},this),!1!==n&&this.objectPath.splice(n),f};l.prototype.update=function(){var g,f;(g=this.realize())!==this.target&&(v(this.target)&&this.set(!1,this.key,
  this.target,this.callback),v(g)&&this.set(!0,this.key,g,this.callback),f=this.value(),this.target=g,(this.value()instanceof Function||this.value()!==f)&&this.callback())};l.prototype.value=function(){return v(this.target)?this.get(this.key,this.target):void 0};l.prototype.setValue=function(g){v(this.target)&&this.adapter(this.key).set(this.target,this.key.path,g)};l.prototype.get=function(g,f){return this.adapter(g).get(f,g.path)};l.prototype.set=function(g,f,l,q){g=g?"observe":"unobserve";this.adapter(f)[g](l,
  f.path,q)};l.prototype.interfaces=function(){var g=Object.keys(this.options.adapters);return Object.keys(q.adapters).forEach(function(f){~g.indexOf(f)||g.push(f)}),g};l.prototype.adapter=function(g){return this.options.adapters[g.i]||q.adapters[g.i]};l.prototype.unobserve=function(){var g;this.tokens.forEach(function(f,l){(g=this.objectPath[l])&&this.set(!1,f,g,this.update)},this);v(this.target)&&this.set(!1,this.key,this.target,this.callback)};"undefined"!=typeof module&&module.exports?module.exports=
  q:"function"==typeof define&&define.amd?define([],function(){return this.sightglass=q}):this.sightglass=q}).call(this);
  (function(){var q,l,v,g,f=function(a,b){return function(){return a.apply(b,arguments)}},n=[].slice,z={}.hasOwnProperty,p=function(a,b){function c(){this.constructor=a}for(var d in b)z.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},w=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};var h={options:"prefix templateDelimiters rootInterface preloadData handler executeFunctions".split(" "),extensions:["binders",
  "formatters","components","adapters"],"public":{binders:{},components:{},formatters:{},adapters:{},prefix:"rv",templateDelimiters:["{","}"],rootInterface:".",preloadData:!0,executeFunctions:!1,iterationAlias:function(a){return"%"+a+"%"},handler:function(a,b,c){return this.call(a,b,c.view.models)},configure:function(a){var b,c,d;null==a&&(a={});for(c in a)if(d=a[c],"binders"===c||"components"===c||"formatters"===c||"adapters"===c)for(b in d){var e=d[b];h[c][b]=e}else h["public"][c]=d},bind:function(a,
  b,c){var d;return null==b&&(b={}),null==c&&(c={}),d=new h.View(a,b,c),d.bind(),d},init:function(a,b,c){var d,e,k;if(null==c&&(c={}),null==b&&(b=document.createElement("div")),a=h["public"].components[a],e=a.template.call(this,b),e instanceof HTMLElement){for(;b.firstChild;)b.removeChild(b.firstChild);b.appendChild(e)}else b.innerHTML=e;return d=a.initialize.call(this,b,c),k=new h.View(b,d),k.bind(),k}}};window.jQuery||window.$?(l=window.jQuery||window.$,g="on"in l.prototype?["on","off"]:["bind","unbind"],
  q=g[0],v=g[1],h.Util={bindEvent:function(a,b,c){return l(a)[q](b,c)},unbindEvent:function(a,b,c){return l(a)[v](b,c)},getInputValue:function(a){var b;return b=l(a),"checkbox"===b.attr("type")?b.is(":checked"):b.val()}}):h.Util={bindEvent:function(){return"addEventListener"in window?function(a,b,c){return a.addEventListener(b,c,!1)}:function(a,b,c){return a.attachEvent("on"+b,c)}}(),unbindEvent:function(){return"removeEventListener"in window?function(a,b,c){return a.removeEventListener(b,c,!1)}:function(a,
  b,c){return a.detachEvent("on"+b,c)}}(),getInputValue:function(a){var b;if("checkbox"===a.type)return a.checked;if("select-multiple"===a.type){var c=[];var d=0;for(b=a.length;b>d;d++){var e=a[d];e.selected&&c.push(e.value)}return c}return a.value}};h.TypeParser=function(){function a(){}return a.types={primitive:0,keypath:1},a.parse=function(b){return/^'.*'$|^".*"$/.test(b)?{type:this.types.primitive,value:b.slice(1,-1)}:"true"===b?{type:this.types.primitive,value:!0}:"false"===b?{type:this.types.primitive,
  value:!1}:"null"===b?{type:this.types.primitive,value:null}:"undefined"===b?{type:this.types.primitive,value:void 0}:""===b?{type:this.types.primitive,value:void 0}:!1===isNaN(Number(b))?{type:this.types.primitive,value:Number(b)}:{type:this.types.keypath,value:b}},a}();h.TextTemplateParser=function(){function a(){}return a.types={text:0,binding:1},a.parse=function(b,a){var c,e;var k=[];var m=b.length;for(e=c=0;m>e;){if(c=b.indexOf(a[0],e),0>c){k.push({type:this.types.text,value:b.slice(e)});break}if(0<
  c&&c>e&&k.push({type:this.types.text,value:b.slice(e,c)}),e=c+a[0].length,c=b.indexOf(a[1],e),0>c){m=b.slice(e-a[1].length);c=k[k.length-1];(null!=c?c.type:void 0)===this.types.text?c.value+=m:k.push({type:this.types.text,value:m});break}e=b.slice(e,c).trim();k.push({type:this.types.binding,value:e});e=c+a[1].length}return k},a}();h.View=function(){function a(b,c,a){var d,k,m,u;this.els=b;this.models=c;null==a&&(a={});this.update=f(this.update,this);this.publish=f(this.publish,this);this.sync=f(this.sync,
  this);this.unbind=f(this.unbind,this);this.bind=f(this.bind,this);this.select=f(this.select,this);this.traverse=f(this.traverse,this);this.build=f(this.build,this);this.buildBinding=f(this.buildBinding,this);this.bindingRegExp=f(this.bindingRegExp,this);this.options=f(this.options,this);this.els.jquery||this.els instanceof Array||(this.els=[this.els]);var x=h.extensions;c=0;for(m=x.length;m>c;c++){if(d=x[c],this[d]={},a[d]){var y=a[d];for(r in y)b=y[r],this[d][r]=b}y=h["public"][d];for(r in y)b=y[r],
  null==(k=this[d])[r]&&(k[r]=b)}b=h.options;var r=0;for(k=b.length;k>r;r++)d=b[r],this[d]=null!=(u=a[d])?u:h["public"][d];this.build()}return a.prototype.options=function(){var b;var a={};var d=h.extensions.concat(h.options);var e=0;for(b=d.length;b>e;e++){var k=d[e];a[k]=this[k]}return a},a.prototype.bindingRegExp=function(){return new RegExp("^"+this.prefix+"-")},a.prototype.buildBinding=function(b,a,d,e){var c,m,u,x,f,r,g;return f={},g=function(){var b;var a=e.match(/((?:'[^']*')*(?:(?:[^\|']*(?:'[^']*')+[^\|']*)+|[^\|]+))|^$/g);
  var c=[];var d=0;for(b=a.length;b>d;d++)r=a[d],c.push(r.trim());return c}(),c=function(){var b;var a=g.shift().split("<");var c=[];var d=0;for(b=a.length;b>d;d++)m=a[d],c.push(m.trim());return c}(),x=c.shift(),f.formatters=g,(u=c.shift())&&(f.dependencies=u.split(/\s+/)),this.bindings.push(new h[b](this,a,d,x,f))},a.prototype.build=function(){var b;this.bindings=[];var a=function(b){return function(c){var d,e,k,m,u;if(3===c.nodeType){if(k=h.TextTemplateParser,(e=b.templateDelimiters)&&(m=k.parse(c.data,
  e)).length&&(1!==m.length||m[0].type!==k.types.text)){var f=0;for(u=m.length;u>f;f++)k=m[f],e=document.createTextNode(k.value),c.parentNode.insertBefore(e,c),1===k.type&&b.buildBinding("TextBinding",e,null,k.value);c.parentNode.removeChild(c)}}else 1===c.nodeType&&(d=b.traverse(c));if(!d){k=c.childNodes;c=[];m=0;for(e=k.length;e>m;m++)d=k[m],c.push(d);m=0;for(e=c.length;e>m;m++)d=c[m],a(d)}}}(this);var d=this.els;var e=0;for(b=d.length;b>e;e++){var k=d[e];a(k)}this.bindings.sort(function(b,c){var a,
  d;return((null!=(a=c.binder)?a.priority:void 0)||0)-((null!=(d=b.binder)?d.priority:void 0)||0)})},a.prototype.traverse=function(b){var a,d,e,k,m,u;var f=this.bindingRegExp();var g="SCRIPT"===b.nodeName||"STYLE"===b.nodeName;var r=b.attributes;var l=0;for(u=r.length;u>l;l++)if(a=r[l],f.test(a.name)){if(m=a.name.replace(f,""),!(e=this.binders[m])){var n=this.binders;for(p in n){var q=n[p];"*"!==p&&-1!==p.indexOf("*")&&(k=new RegExp("^"+p.replace(/\*/g,".+")+"$"),k.test(m)&&(e=q))}}e||(e=this.binders["*"]);
  e.block&&(g=!0,d=[a])}var p=d||b.attributes;d=0;for(e=p.length;e>d;d++)a=p[d],f.test(a.name)&&(m=a.name.replace(f,""),this.buildBinding("Binding",b,m,a.value));return g||(m=b.nodeName.toLowerCase(),this.components[m]&&!b._bound&&(this.bindings.push(new h.ComponentBinding(this,b,m)),g=!0)),g},a.prototype.select=function(b){var a;var d=this.bindings;var e=[];var k=0;for(a=d.length;a>k;k++){var m=d[k];b(m)&&e.push(m)}return e},a.prototype.bind=function(){var b;var a=this.bindings;var d=0;for(b=a.length;b>
  d;d++){var e=a[d];e.bind()}},a.prototype.unbind=function(){var b;var a=this.bindings;var d=0;for(b=a.length;b>d;d++){var e=a[d];e.unbind()}},a.prototype.sync=function(){var b;var a=this.bindings;var d=0;for(b=a.length;b>d;d++){var e=a[d];"function"==typeof e.sync&&e.sync()}},a.prototype.publish=function(){var b;var a=this.select(function(b){var a;return null!=(a=b.binder)?a.publishes:void 0});var d=0;for(b=a.length;b>d;d++){var e=a[d];e.publish()}},a.prototype.update=function(b){var a;null==b&&(b=
  {});for(k in b){var d=b[k];this.models[k]=d}var e=this.bindings;d=0;for(a=e.length;a>d;d++){var k=e[d];"function"==typeof k.update&&k.update(b)}},a}();h.Binding=function(){function a(b,a,d,e,k){this.view=b;this.el=a;this.type=d;this.keypath=e;this.options=null!=k?k:{};this.getValue=f(this.getValue,this);this.update=f(this.update,this);this.unbind=f(this.unbind,this);this.bind=f(this.bind,this);this.publish=f(this.publish,this);this.sync=f(this.sync,this);this.set=f(this.set,this);this.eventHandler=
  f(this.eventHandler,this);this.formattedValue=f(this.formattedValue,this);this.parseFormatterArguments=f(this.parseFormatterArguments,this);this.parseTarget=f(this.parseTarget,this);this.observe=f(this.observe,this);this.setBinder=f(this.setBinder,this);this.formatters=this.options.formatters||[];this.dependencies=[];this.formatterObservers={};this.model=void 0;this.setBinder()}return a.prototype.setBinder=function(){var b,a;if(!(this.binder=this.view.binders[this.type])){var d=this.view.binders;
  for(b in d){var e=d[b];"*"!==b&&-1!==b.indexOf("*")&&(a=new RegExp("^"+b.replace(/\*/g,".+")+"$"),a.test(this.type)&&(this.binder=e,this.args=(new RegExp("^"+b.replace(/\*/g,"(.+)")+"$")).exec(this.type),this.args.shift()))}}return this.binder||(this.binder=this.view.binders["*"]),this.binder instanceof Function?this.binder={routine:this.binder}:void 0},a.prototype.observe=function(b,a,d){return h.sightglass(b,a,d,{root:this.view.rootInterface,adapters:this.view.adapters})},a.prototype.parseTarget=
  function(){var b;return b=h.TypeParser.parse(this.keypath),b.type===h.TypeParser.types.primitive?this.value=b.value:(this.observer=this.observe(this.view.models,this.keypath,this.sync),this.model=this.observer.target)},a.prototype.parseFormatterArguments=function(b,a){var c,e,k,m;var f=[];var g=0;for(e=b.length;e>g;g++){var l=b[g];f.push(h.TypeParser.parse(l))}b=f;e=[];g=f=0;for(m=b.length;m>f;g=++f)l=b[g],e.push(l.type===h.TypeParser.types.primitive?l.value:((k=this.formatterObservers)[a]||(k[a]=
  {}),(c=this.formatterObservers[a][g])?void 0:(c=this.observe(this.view.models,l.value,this.sync),this.formatterObservers[a][g]=c),c.value()));return e},a.prototype.formattedValue=function(b){var a,d,e;var k=this.formatters;var m=a=0;for(d=k.length;d>a;m=++a){var f=k[m];var h=f.match(/[^\s']+|'([^']|'[^\s])*'|"([^"]|"[^\s])*"/g);f=h.shift();f=this.view.formatters[f];h=this.parseFormatterArguments(h,m);(null!=f?f.read:void 0)instanceof Function?b=(e=f.read).call.apply(e,[this.model,b].concat(n.call(h))):
  f instanceof Function&&(b=f.call.apply(f,[this.model,b].concat(n.call(h))))}return b},a.prototype.eventHandler=function(b){var a,d;return d=(a=this).view.handler,function(c){return d.call(b,this,c,a)}},a.prototype.set=function(b){var a;return b=b instanceof Function&&!this.binder["function"]&&h["public"].executeFunctions?this.formattedValue(b.call(this.model)):this.formattedValue(b),null!=(a=this.binder.routine)?a.call(this,this.el,b):void 0},a.prototype.sync=function(){var b,a;return this.set(function(){var c,
  e;if(this.observer){if(this.model!==this.observer.target){var k=this.dependencies;var m=0;for(c=k.length;c>m;m++)a=k[m],a.unobserve();if(this.dependencies=[],null!=(this.model=this.observer.target)&&(null!=(e=this.options.dependencies)?e.length:void 0))for(k=this.options.dependencies,m=0,c=k.length;c>m;m++)b=k[m],a=this.observe(this.model,b,this.sync),this.dependencies.push(a)}return this.observer.value()}return this.value}.call(this))},a.prototype.publish=function(){var b,a,d,e;if(this.observer){var k=
  this.getValue(this.el);var m=this.formatters.length-1;var f=this.formatters.slice(0).reverse();var h=b=0;for(a=f.length;a>b;h=++b){var g=f[h];h=m-h;var l=g.split(/\s+/);g=l.shift();h=this.parseFormatterArguments(l,h);null!=(d=this.view.formatters[g])&&d.publish&&(k=(e=this.view.formatters[g]).publish.apply(e,[k].concat(n.call(h))))}return this.observer.setValue(k)}},a.prototype.bind=function(){var a,c;if(this.parseTarget(),null!=(a=this.binder.bind)&&a.call(this,this.el),null!=this.model&&(null!=
  (c=this.options.dependencies)?c.length:void 0)){var d=this.options.dependencies;a=0;for(c=d.length;c>a;a++){var e=d[a];e=this.observe(this.model,e,this.sync);this.dependencies.push(e)}}return this.view.preloadData?this.sync():void 0},a.prototype.unbind=function(){var a,c,d,e,k;null!=(e=this.binder.unbind)&&e.call(this,this.el);null!=(c=this.observer)&&c.unobserve();var f=this.dependencies;c=0;for(k=f.length;k>c;c++)e=f[c],e.unobserve();this.dependencies=[];k=this.formatterObservers;for(d in k)for(a in c=
  k[d],c)e=c[a],e.unobserve();return this.formatterObservers={}},a.prototype.update=function(a){var b,d;return null==a&&(a={}),this.model=null!=(b=this.observer)?b.target:void 0,null!=(d=this.binder.update)?d.call(this,a):void 0},a.prototype.getValue=function(a){return this.binder&&null!=this.binder.getValue?this.binder.getValue.call(this,a):h.Util.getInputValue(a)},a}();h.ComponentBinding=function(a){function b(a,b,e){var c,d,g,l;this.view=a;this.el=b;this.type=e;this.unbind=f(this.unbind,this);this.bind=
  f(this.bind,this);this.locals=f(this.locals,this);this.component=this.view.components[this.type];this["static"]={};this.observers={};this.upstreamObservers={};b=a.bindingRegExp();var n=this.el.attributes||[];e=0;for(g=n.length;g>e;e++)a=n[e],b.test(a.name)||(c=this.camelCase(a.name),d=h.TypeParser.parse(a.value),0<=w.call(null!=(l=this.component["static"])?l:[],c)?this["static"][c]=a.value:d.type===h.TypeParser.types.primitive?this["static"][c]=d.value:this.observers[c]=a.value)}return p(b,a),b.prototype.sync=
  function(){},b.prototype.update=function(){},b.prototype.publish=function(){},b.prototype.locals=function(){var a;var b={};var e=this["static"];for(a in e){var k=e[a];b[a]=k}e=this.observers;for(a in e)k=e[a],b[a]=k.value();return b},b.prototype.camelCase=function(a){return a.replace(/-([a-z])/g,function(a){return a[1].toUpperCase()})},b.prototype.bind=function(){var a,b,e,k,f;if(!this.bound){var g=this.observers;for(a in g){var l=g[a];this.observers[a]=this.observe(this.view.models,l,function(a){return function(b){return function(){return a.componentView.models[b]=
  a.observers[b].value()}}}(this).call(this,a))}this.bound=!0}if(null!=this.componentView)this.componentView.bind();else{this.el.innerHTML=this.component.template.call(this);g=this.component.initialize.call(this,this.el,this.locals());this.el._bound=!0;l={};var n=h.extensions;var r=0;for(k=n.length;k>r;r++){if(b=n[r],l[b]={},this.component[b]){var p=this.component[b];for(t in p){var q=p[t];l[b][t]=q}}p=this.view[b];for(t in p)q=p[t],null==(e=l[b])[t]&&(e[t]=q)}q=h.options;var t=0;for(e=q.length;e>t;t++)b=
  q[t],l[b]=null!=(f=this.component[b])?f:this.view[b];this.componentView=new h.View(Array.prototype.slice.call(this.el.childNodes),g,l);this.componentView.bind();f=this.observers;for(a in f)b=f[a],this.upstreamObservers[a]=this.observe(this.componentView.models,a,function(a){return function(b,c){return function(){return c.setValue(a.componentView.models[b])}}}(this).call(this,a,b))}},b.prototype.unbind=function(){var a,b;var e=this.upstreamObservers;for(a in e){var k=e[a];k.unobserve()}e=this.observers;
  for(a in e)k=e[a],k.unobserve();return null!=(b=this.componentView)?b.unbind.call(this):void 0},b}(h.Binding);h.TextBinding=function(a){function b(a,b,e,k,h){this.view=a;this.el=b;this.type=e;this.keypath=k;this.options=null!=h?h:{};this.sync=f(this.sync,this);this.formatters=this.options.formatters||[];this.dependencies=[];this.formatterObservers={}}return p(b,a),b.prototype.binder={routine:function(a,b){return a.data=null!=b?b:""}},b.prototype.sync=function(){return b.__super__.sync.apply(this,
  arguments)},b}(h.Binding);h["public"].binders.text=function(a,b){return null!=a.textContent?a.textContent=null!=b?b:"":a.innerText=null!=b?b:""};h["public"].binders.html=function(a,b){return a.innerHTML=null!=b?b:""};h["public"].binders.show=function(a,b){return a.style.display=b?"":"none"};h["public"].binders.hide=function(a,b){return a.style.display=b?"none":""};h["public"].binders.enabled=function(a,b){return a.disabled=!b};h["public"].binders.disabled=function(a,b){return a.disabled=!!b};h["public"].binders.checked=
  {publishes:!0,priority:2E3,bind:function(a){return h.Util.bindEvent(a,"change",this.publish)},unbind:function(a){return h.Util.unbindEvent(a,"change",this.publish)},routine:function(a,b){var c;return a.checked="radio"===a.type?(null!=(c=a.value)?c.toString():void 0)===(null!=b?b.toString():void 0):!!b}};h["public"].binders.unchecked={publishes:!0,priority:2E3,bind:function(a){return h.Util.bindEvent(a,"change",this.publish)},unbind:function(a){return h.Util.unbindEvent(a,"change",this.publish)},routine:function(a,
  b){var c;return a.checked="radio"===a.type?(null!=(c=a.value)?c.toString():void 0)!==(null!=b?b.toString():void 0):!b}};h["public"].binders.value={publishes:!0,priority:3E3,bind:function(a){return"INPUT"!==a.tagName||"radio"!==a.type?(this.event="SELECT"===a.tagName?"change":"input",h.Util.bindEvent(a,this.event,this.publish)):void 0},unbind:function(a){return"INPUT"!==a.tagName||"radio"!==a.type?h.Util.unbindEvent(a,this.event,this.publish):void 0},routine:function(a,b){var c,d,e;if("INPUT"===a.tagName&&
  "radio"===a.type)return a.setAttribute("value",b);if(null!=window.jQuery){if(a=l(a),(null!=b?b.toString():void 0)!==(null!=(c=a.val())?c.toString():void 0))return a.val(null!=b?b:"")}else if("select-multiple"===a.type){if(null!=b){var k=[];var f=0;for(d=a.length;d>f;f++)c=a[f],k.push(c.selected=(e=c.value,0<=w.call(b,e)));return k}}else if((null!=b?b.toString():void 0)!==(null!=(f=a.value)?f.toString():void 0))return a.value=null!=b?b:""}};h["public"].binders["if"]={block:!0,priority:4E3,bind:function(a){var b,
  c;return null==this.marker?(b=[this.view.prefix,this.type].join("-").replace("--","-"),c=a.getAttribute(b),this.marker=document.createComment(" rivets: "+this.type+" "+c+" "),this.bound=!1,a.removeAttribute(b),a.parentNode.insertBefore(this.marker,a),a.parentNode.removeChild(a)):void 0},unbind:function(){return this.nested?(this.nested.unbind(),this.bound=!1):void 0},routine:function(a,b){var c;if(!!b==!this.bound){if(b){var d={};var e=this.view.models;for(c in e){var k=e[c];d[c]=k}return(this.nested||
  (this.nested=new h.View(a,d,this.view.options()))).bind(),this.marker.parentNode.insertBefore(a,this.marker.nextSibling),this.bound=!0}return a.parentNode.removeChild(a),this.nested.unbind(),this.bound=!1}},update:function(a){var b;return null!=(b=this.nested)?b.update(a):void 0}};h["public"].binders.unless={block:!0,priority:4E3,bind:function(a){return h["public"].binders["if"].bind.call(this,a)},unbind:function(){return h["public"].binders["if"].unbind.call(this)},routine:function(a,b){return h["public"].binders["if"].routine.call(this,
  a,!b)},update:function(a){return h["public"].binders["if"].update.call(this,a)}};h["public"].binders["on-*"]={"function":!0,priority:1E3,unbind:function(a){return this.handler?h.Util.unbindEvent(a,this.args[0],this.handler):void 0},routine:function(a,b){return this.handler&&h.Util.unbindEvent(a,this.args[0],this.handler),h.Util.bindEvent(a,this.args[0],this.handler=this.eventHandler(b))}};h["public"].binders["each-*"]={block:!0,priority:4E3,bind:function(a){var b;if(null==this.marker){var c=[this.view.prefix,
  this.type].join("-").replace("--","-");this.marker=document.createComment(" rivets: "+this.type+" ");this.iterated=[];a.removeAttribute(c);a.parentNode.insertBefore(this.marker,a);a.parentNode.removeChild(a)}else{var d=this.iterated;c=0;for(b=d.length;b>c;c++)a=d[c],a.bind()}},unbind:function(){var a;if(null!=this.iterated){var b=this.iterated;var c=0;for(a=b.length;a>c;c++){var d=b[c];d.unbind()}}},routine:function(a,b){var c,d,e;if(e=this.args[0],b=b||[],this.iterated.length>b.length){var k=Array(this.iterated.length-
  b.length);var f=0;for(k=k.length;k>f;f++){var g=this.iterated.pop();g.unbind();this.marker.parentNode.removeChild(g.els[0])}}g=f=0;for(k=b.length;k>f;g=++f)if(d=b[g],c={index:g},c[h["public"].iterationAlias(e)]=g,c[e]=d,null==this.iterated[g]){g=this.view.models;for(r in g)d=g[r],null==c[r]&&(c[r]=d);var l=this.iterated.length?this.iterated[this.iterated.length-1].els[0]:this.marker;g=this.view.options();g.preloadData=!0;var n=a.cloneNode(!0);g=new h.View(n,c,g);g.bind();this.iterated.push(g);this.marker.parentNode.insertBefore(n,
  l.nextSibling)}else this.iterated[g].models[e]!==d&&this.iterated[g].update(c);if("OPTION"===a.nodeName){e=this.view.bindings;var r=0;for(d=e.length;d>r;r++)c=e[r],c.el===this.marker.parentNode&&"value"===c.type&&c.sync()}},update:function(a){var b={};for(e in a){var c=a[e];e!==this.args[0]&&(b[e]=c)}var d=this.iterated;var e=0;for(c=d.length;c>e;e++)a=d[e],a.update(b)}};h["public"].binders["class-*"]=function(a,b){var c;return c=" "+a.className+" ",!b==(-1!==c.indexOf(" "+this.args[0]+" "))?a.className=
  b?""+a.className+" "+this.args[0]:c.replace(" "+this.args[0]+" "," ").trim():void 0};h["public"].binders["*"]=function(a,b){return null!=b?a.setAttribute(this.type,b):a.removeAttribute(this.type)};h["public"].formatters.call=function(){var a,b;return b=arguments[0],a=2<=arguments.length?n.call(arguments,1):[],b.call.apply(b,[this].concat(n.call(a)))};h["public"].adapters["."]={id:"_rv",counter:0,weakmap:{},weakReference:function(a){var b,c,d;return a.hasOwnProperty(this.id)||(b=this.counter++,Object.defineProperty(a,
  this.id,{value:b})),(c=this.weakmap)[d=a[this.id]]||(c[d]={callbacks:{}})},cleanupWeakReference:function(a,b){return Object.keys(a.callbacks).length||a.pointers&&Object.keys(a.pointers).length?void 0:delete this.weakmap[b]},stubFunction:function(a,b){var c,d,e;return d=a[b],c=this.weakReference(a),e=this.weakmap,a[b]=function(){var b,f,g,h;var l=d.apply(a,arguments);var n=c.pointers;for(b in n){var p=n[b];var q=null!=(g=null!=(h=e[b])?h.callbacks[p]:void 0)?g:[];var t=0;for(f=q.length;f>t;t++)p=q[t],
  p()}return l}},observeMutations:function(a,b,c){var d,e,f;if(Array.isArray(a)){if(d=this.weakReference(a),null==d.pointers){d.pointers={};var g="push pop shift unshift sort reverse splice".split(" ");var h=0;for(f=g.length;f>h;h++){var l=g[h];this.stubFunction(a,l)}}if(null==(e=d.pointers)[b]&&(e[b]=[]),0>w.call(d.pointers[b],c))return d.pointers[b].push(c)}},unobserveMutations:function(a,b,c){var d,e,f;return Array.isArray(a)&&null!=a[this.id]&&(e=this.weakmap[a[this.id]])&&(f=e.pointers[b])?(0<=
  (d=f.indexOf(c))&&f.splice(d,1),f.length||delete e.pointers[b],this.cleanupWeakReference(e,a[this.id])):void 0},observe:function(a,b,c){var d,e,f;return d=this.weakReference(a).callbacks,null==d[b]&&(d[b]=[],e=Object.getOwnPropertyDescriptor(a,b),(null!=e?e.get:void 0)||(null!=e?e.set:void 0)||(f=a[b],Object.defineProperty(a,b,{enumerable:!0,get:function(){return f},set:function(c){return function(e){var g,h;if(e!==f&&(c.unobserveMutations(f,a[c.id],b),f=e,g=c.weakmap[a[c.id]])){if(d=g.callbacks,
  d[b]){var k=d[b].slice();var l=0;for(h=k.length;h>l;l++)g=k[l],0<=w.call(d[b],g)&&g()}return c.observeMutations(e,a[c.id],b)}}}(this)}))),0>w.call(d[b],c)&&d[b].push(c),this.observeMutations(a[b],a[this.id],b)},unobserve:function(a,b,c){var d,e,f;return(f=this.weakmap[a[this.id]])&&(d=f.callbacks[b])?(0<=(e=d.indexOf(c))&&(d.splice(e,1),d.length||(delete f.callbacks[b],this.unobserveMutations(a[b],a[this.id],b))),this.cleanupWeakReference(f,a[this.id])):void 0},get:function(a,b){return a[b]},set:function(a,
  b,c){return a[b]=c}};h.factory=function(a){return h.sightglass=a,h["public"]._=h,h["public"]};"object"==typeof("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=h.factory(require("sightglass")):"function"==typeof define&&define.amd?define(["sightglass"],function(a){return this.rivets=h.factory(a)}):this.rivets=h.factory(sightglass)}).call(this);